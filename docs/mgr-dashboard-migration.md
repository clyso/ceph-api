# MGR api migration plan

[Dashboard OpenAPI](https://petstore.swagger.io/?url=https://raw.githubusercontent.com/ceph/ceph/main/src/pybind/mgr/dashboard/openapi.yaml)

| API group              | status | notes                                                                                                                                                                                                                                                                                                            | source                                 |
| ---------------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| Auth                   | ‚úÖ     | Call mon command                                                                                                                                                                                                                                                                                                 |                                        |
| Cluster                | ‚úÖ     | Call mon command                                                                                                                                                                                                                                                                                                 |                                        |
| User                   | ‚úÖ     | Call mon command                                                                                                                                                                                                                                                                                                 |                                        |
| ClusterConfiguration   | ‚òê      | Involves Interacting with MGR plus MGR command                                                                                                                                                                                                                                                                   |                                        |
| CrushRule              | üîé     | **GET:**<br>Involves Interacting with MGR (`"mgr.get('osd_map_crush')['rules']"`)<br><br>**POST:**<br>Command:`'mon', 'osd crush rule create-erasure'` or `('mon', 'osd crush rule create-replicated'`<br><br><br>**DELETE:**<br>Command: `'mon', 'osd crush rule rm'`                                           | Ceph Code (crush_rule.py)              |
| Daemon                 | ‚òê      | **GET:**<br>Takes the instance of orchestrator and returns the list of orchestrators, getting an exception while executing the API in `lima-ceph` claiming no orchestrator available.<br><br>**PUT:**<br>Can't run the API for this as no orchestrator available, <br>                                           | Ceph Code (daemon.py)                  |
| ErasureCodeProfile     | ‚òê      | **GET:**<br>List the erasure profiles from the ceph service, no mon command detected while calling the API and cannot locate the command in the code as well.<br><br>**POST:**<br>Command: `'mon', 'osd erasure-code-profile set'`<br><br>**DELETE:**<br>Command: `'mon', 'osd erasure-code-profile rm'`<br><br> | Ceph Code<br>(erasure_code_profile.py) |
| FeatureTogglesEndpoint | ‚òê      | **GET:**<br>It seems to be a plugin and not included in the core code, also cannot detect the command for it via CLI or code.<br><br>                                                                                                                                                                            | Ceph Code (feature_toggles.py)         |
| Hardware               | ‚òê      | **GET:**<br>Hardware is a service which interacts with the orchestrator client to get hardware health status                                                                                                                                                                                                     | Ceph Code<br>(hardware.py)             |
| Health                 | ‚òê      | **GET:** (All Endpoints)<br>Gets the health status, interacting with the manager unable to find commands.<br>                                                                                                                                                                                                    | Ceph Code <br>(health.py)              |
| Host                   | ‚òê      | **(All Endpoints)**:<br>Unable to get the command, code interacting directly with the ceph manager.<br>                                                                                                                                                                                                          | Ceph Code<br>(host.py)                 |
| Iscsi                  | ‚òê      | Need to make our own ISCSI client. NOTE: _The iSCSI gateway is in maintenance as of November 2022. This means that it is no longer in active development and will not be updated to add new features._                                                                                                           | Ceph Code<br>(host.py)                 |
| Logs                   | ‚òê      | **GET:**<br>Command: ` 'mon', 'log last'`                                                                                                                                                                                                                                                                        | Ceph Code<br>(logs.py)                 |
| MgrModule              | ‚òê      | **(All Endpoints)**<br>All endpoints have dependency on the ceph manager, 2 mon commands were used to enable/disable a manager module but to perform some checks ceph manager was used:<br>enable command: ` 'mon', 'mgr module enable'`<br>disable command: ` 'mon', 'mgr module disable'`                      | Ceph code<br>(mgr_modules.py)          |
| OSD                    | ‚òê      | Without Commands:<br> - `/api/osd`<br> - `/api/osd/flags`<br> - `/api/osd/safe_to_delete`<br>Commands:<br>Safe to Destroy: `'mon', 'osd safe-to-destroy'`<br>Settings: `'mon', 'osd dump'`<br>                                                                                                                   |                                        |
|                        |        |                                                                                                                                                                                                                                                                                                                  |                                        |
